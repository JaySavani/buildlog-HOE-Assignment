datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

enum Role {
    USER
    ADMIN
}

enum ProjectStatus {
    PENDING
    APPROVED
    REJECTED
}

model User {
    id       String @id @default(cuid())
    fullName String
    email    String @unique
    password String
    role     Role   @default(USER)

    projects  Project[]
    // votes     Vote[]
    // feedbacks Feedback[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Project {
    id          String        @id @default(cuid())
    title       String
    slug        String        @unique
    description String
    githubUrl   String
    websiteUrl  String?
    status      ProjectStatus @default(PENDING)

    authorId String
    author   User   @relation(fields: [authorId], references: [id])

    categories ProjectCategory[]
    // votes      Vote[]
    // feedbacks  Feedback[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([status])
    @@index([createdAt])
}

model Category {
    id    String @id @default(cuid())
    name  String @unique
    color String

    projects ProjectCategory[]

    createdAt DateTime @default(now())
}

model ProjectCategory {
    projectId  String
    categoryId String

    project  Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
    category Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

    @@id([projectId, categoryId])
}

// model Vote {
//     id    String @id @default(cuid())
//     value Int // +1 (upvote) or -1 (downvote)

//     userId    String
//     projectId String

//     user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
//     project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

//     createdAt DateTime @default(now())

//     @@unique([userId, projectId])
// }

// model Feedback {
//     id      String
//     content String

//     userId    String
//     projectId String

//     user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
//     project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

//     createdAt DateTime @default(now())

//     @@id([id])
// }
